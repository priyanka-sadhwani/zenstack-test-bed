"use strict";
/* eslint-disable @typescript-eslint/no-explicit-any */
Object.defineProperty(exports, "__esModule", { value: true });
exports.simpleTraverse = simpleTraverse;
function simpleTraverse(root, cb) {
    const path = [];
    const parents = [];
    function walker(node) {
        const isObject = typeof node === 'object' && node !== null;
        const isCircular = isObject && parents.some((p) => p === node);
        let keepGoing = true;
        function update(nextValue) {
            if (path.length) {
                const parent = parents[parents.length - 1];
                const key = path[path.length - 1];
                parent[key] = nextValue;
            }
            node = nextValue;
            keepGoing = false;
        }
        cb({
            path: [...path],
            key: path[path.length - 1],
            value: node,
            update,
        });
        if (!keepGoing)
            return node;
        if (isObject && !isCircular) {
            parents.push(node);
            Object.keys(node).forEach((key) => {
                path.push(key);
                walker(node[key]);
                path.pop();
            });
            parents.pop();
        }
        return node;
    }
    return walker(root);
}
//# sourceMappingURL=simple-traverse.js.map